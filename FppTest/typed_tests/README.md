# FppTest/typed_tests

This directory contains the following type-parametrized test suites for 
C++ code generated by the FPP autocoder.

* `EnumTest`: Tests an enum class
* `ArrayTest`: Tests an array class
* `StringTest`: Tests a nested string class within an array of struct class

## Instantiating a Test Suite

To use a type-parametrized test suite, instantiate it with a list of types:

```c++
#include "FppTest/typed_tests/TestSuite.hpp"

using TestTypes = ::testing::Types<
    Type1,
    Type2,
    Type3
>;
INSTANTIATE_TYPED_TEST_SUITE_P(InstanceName, 
                               TestSuite, 
                               TestTypes);
```

For example, to instantiate the `ArrayTest` suite with array types `ArrayType1`
and `ArrayType2`:

```c++
#include "FppTest/typed_tests/ArrayTest.hpp"

using ArrayTypes = ::testing::Types<
    ArrayType1,
    ArrayType2
>;
INSTANTIATE_TYPED_TEST_SUITE_P(ExampleInstance, 
                               ArrayTest, 
                               ArrayTypes);
```

## Defining Specializations

In addition to instantiating the test suite, you may also need to define some
explicit specializations for template functions if the behavior of your class
differs from the provided default implementation.

### `EnumTest` Suite

- `getDefaultValue()`: Returns the default value of an enum type. The default
implementation returns 0.

  ```c++
  // Function signature
  template <typename EnumType>
  typename EnumType::T getDefaultValue();
  ```

- `getValidValue()`: Returns a random valid enum value. The default implementation
assumes the values of the enum have been implicitly defined, i.e. it returns
a value in the interval `[0, EnumType::NUM_CONSTANTS-1]`.

  ```c++
  // Function signature
  template <typename EnumType>
  typename EnumType::T getValidValue();
  ```

- `getInvalidValue()`: Returns an random invalid enum value. The default
implementation assumes the values of the enum have been implicitly defined,
i.e. it returns a value either in the interval `[min, -1]` (if the serial
representation type is signed) or in the interval
`[EnumType::NUM_CONSTANTS, max]`, where `min` and `max` are the minimum
and maximum values of the serial representation type, respectively.

  ```c++
  // Function signature
  template <typename EnumType>
  typename EnumType::T getInvalidValue();
  ```

### `ArrayTest` Suite

The following functions MUST be implemented for your array type!

- `setTestVals()`: Sets test values for an array. There is no default
implementation, so this function must be implemented for your array type!
In addition, these test values must be different from the default values.

  ```c++
  // Function signature
  template <typename ArrayType>
  void setTestVals(typename ArrayType::ElementType (&a)[ArrayType::SIZE]);
  ```

- `getMultiElementConstructedArray()`: Returns an array constructed using its
multiple element constructor. There is no default implementation, so this
function must be implemented for your array type!

  ```c++
  // Function signature
  template <typename ArrayType>
  ArrayType getMultiElementConstructedArray
      (typename ArrayType::ElementType (&a)[ArrayType::SIZE]);
  ```

The following functions may or may not need to be implemented:

- `setDefaultVals()`: Sets the default values for an array. The default
implementation is empty (i.e. either zero-initialized or default-initialized).

  ```c++
  // Function signature
  template <typename ArrayType>
  void setDefaultVals(typename ArrayType::ElementType (&a)[ArrayType::SIZE]);
  ```

- `getSerializedSize()`: Returns the serialized size of an array. The default
implementation returns the `SERIALIZED_SIZE` of the array type. In particular,
this function will need to be implemented for arrays containing string values.

  ```c++
  // Function signature
  template <typename ArrayType>
  U32 getSerializedSize(typename ArrayType::ElementType (&a)[ArrayType::SIZE]);
  ```

### `StringTest` Suite

- `getSize()`: Returns the size of a string type. The default implementation
returns the default string size of 80.

  ```c++
  // Function signature
  template <typename StringType>
  U32 getSize();
  ```
