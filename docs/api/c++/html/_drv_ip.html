<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>F´ Flight Software - C/C++ Documentation: Drv::Ip IPv4 Socket Implementations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">F´ Flight Software - C/C++ Documentation<span id="projectnumber">&#160;devel</span>
   </div>
   <div id="projectbrief">A framework for building embedded system applications to NASA flight quality standards.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_drv_ip.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Drv::Ip IPv4 Socket Implementations</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md585"></a>
Drv::Ip IPv4 Socket Implementations</h1>
<p>This package contains utility classes to help interact with standard IPv4 (Berkeley) sockets. These classes implement the core features of IPv4. This includes a tcp server socket (<a class="el" href="class_drv_1_1_tcp_server_socket.html" title="Helper for setting up Tcp using Berkeley sockets as a server.">Drv::TcpServerSocket</a>), a tcp client socket (<a class="el" href="namespace_drv.html#a998506404c5fbafa50a8167b3a4772a7">Drv::TcpClient</a>) and a udp socket (<a class="el" href="class_drv_1_1_udp_socket.html" title="Helper for setting up Udp using Berkeley sockets as a client.">Drv::UdpSocket</a>). These are not F´ components, but an F´ component wrapper of each exists: Drv::TcpClientComponent, Drv::TcpServerComponent, and Drv::UdpComponent.</p>
<p>In addition to each individual socket there is a <a class="el" href="class_drv_1_1_ip_socket.html" title="Helper base-class for setting up Berkeley sockets.">Drv::IpSocket</a> base class containing high-level functions for interacting with sockets generically. <a class="el" href="class_drv_1_1_ip_socket.html" title="Helper base-class for setting up Berkeley sockets.">Drv::IpSocket</a> delegates protocol specific functions to protocol functions implemented by the children concrete socket classes. i.e. <a class="el" href="class_drv_1_1_ip_socket.html#aeed642d83d6e65344cc6e4db43f2bc5a" title="open the IP socket for communications">Drv::IpSocket::open</a> delegates to the functions <a class="el" href="class_drv_1_1_tcp_client_socket.html#ac3e7fe8328f36f7c10ec7994ccd3940f" title="Tcp specific implementation for opening a client socket.">Drv::TcpClientSocket::openProtocol</a> to open up specifically a tcp client socket.</p>
<p><a class="el" href="class_drv_1_1_socket_read_task.html" title="supports a task to read a given socket adaptation">Drv::SocketReadTask</a> is a virtual base class that comes with the functionality for setting up a generic reading thread complete with the ability to reconnect to a closed/broken connection. This virtual base class is intended to be inherited by an F´ component wrapper that need to support a receive thread such that this functionality need not be redundantly implemented.</p>
<p>Each of these classes is explained in more detail below.</p>
<ul>
<li>Drv::IpSocket</li>
<li>Drv::TcpClientSocket</li>
<li>Drv::TcpServerSocket</li>
<li>Drv::UdpSocket</li>
<li>Drv::SocketReadTask</li>
</ul>
<h2><a class="anchor" id="autotoc_md586"></a>
Drv::IpSocket Baseclass</h2>
<p>The <a class="el" href="class_drv_1_1_ip_socket.html" title="Helper base-class for setting up Berkeley sockets.">Drv::IpSocket</a> class represents the external interface to IPv4 socket components. This class provides a top-level interface to IPv4 sockets for connecting, disconnecting, sending, and receiving using the socket. This implements the IPv4 socket protocol as provided by the unix (Berkeley) sockets implementation.</p>
<p>High-level interfaces are provided for the standard functions of: <code>open</code>, <code>close</code>, <code>send</code>, and <code>recv</code>. FramingProtocol and implementation specific functionality are implemented in derived classes by implementing the pure virtual functions: <code>openProtocol</code>, <code>sendProtocol</code>, and <code>recvProtocol</code>.</p>
<p>In order to use a <a class="el" href="class_drv_1_1_ip_socket.html" title="Helper base-class for setting up Berkeley sockets.">Drv::IpSocket</a> it must first be configured with a call to the <code><a class="el" href="class_drv_1_1_ip_socket.html#a98a57bf24cdeb8673be4780a8be2db55" title="configure the ip socket with host and transmission timeouts">Drv::IpSocket::configure</a></code> function. Once configured, it can be opened using <code><a class="el" href="class_drv_1_1_ip_socket.html#aeed642d83d6e65344cc6e4db43f2bc5a" title="open the IP socket for communications">Drv::IpSocket::open</a></code>. Opening the socket will verify arguments, allocate system resources and form a connection. In server implementations (<a class="el" href="class_drv_1_1_tcp_server_socket.html" title="Helper for setting up Tcp using Berkeley sockets as a server.">Drv::TcpServerSocket</a>) the open call will block until a client connection has been made. It is safe to assume that a successfully opened socket is ready to send or receive, however; those calls may detect an error and close the socket in response.</p>
<p><code><a class="el" href="class_drv_1_1_ip_socket.html#a8d65fc4ff1e8ea229361b7f025d3520b" title="send data out the IP socket from the given buffer">Drv::TcpServerSocket::send</a></code> will attempt to send data across the socket. It will retry to transmit data a configured number of times on correctable errors before finally succeeding once all data has been transmitted or failing should the socket send fail. Interrupts and timeouts are the only recoverable errors. Other problems result in an error status and when a remote disconnect is detected <code><a class="el" href="class_drv_1_1_ip_socket.html#a083d68f288494c9ffef7a789f846c6bc" title="closes the socket">Drv::IpSocket::close</a></code> is closed to ensure the socket is ready for a subsequent call to <code><a class="el" href="class_drv_1_1_ip_socket.html#aeed642d83d6e65344cc6e4db43f2bc5a" title="open the IP socket for communications">Drv::IpSocket::open</a></code>.</p>
<p><code><a class="el" href="class_drv_1_1_ip_socket.html#ad7e8fbe0b5779b35548173c6fd62fdae" title="receive data from the IP socket from the given buffer">Drv::TcpServerSocket::recv</a></code> will attempt to read data from across the socket. It will block until data is received and in the case that the socket is interrupted without data, it will retry a configurable number of times. Other errors will result in an error status with a specific <code><a class="el" href="class_drv_1_1_ip_socket.html#a083d68f288494c9ffef7a789f846c6bc" title="closes the socket">Drv::IpSocket::close</a></code> call issued in the case of detected disconnects.</p>
<p>A call to <code><a class="el" href="class_drv_1_1_ip_socket.html#a083d68f288494c9ffef7a789f846c6bc" title="closes the socket">Drv::IpSocket::close</a></code> will specifically shutdown and close the client connection. This has the effect of stopping any blocking reads on the socket, issuing a formal disconnect, and cleaning up the allocated resources. Once called, the <a class="el" href="class_drv_1_1_ip_socket.html" title="Helper base-class for setting up Berkeley sockets.">Drv::IpSocket</a> should be ready for another call to <code><a class="el" href="class_drv_1_1_ip_socket.html#aeed642d83d6e65344cc6e4db43f2bc5a" title="open the IP socket for communications">Drv::IpSocket::open</a></code>.</p>
<h3><a class="anchor" id="autotoc_md587"></a>
Example Usage of Drv::IpSocket</h3>
<p>This section will show some example usages of the <a class="el" href="class_drv_1_1_ip_socket.html" title="Helper base-class for setting up Berkeley sockets.">Drv::IpSocket</a>. In this section it is assumed the initialization is done using a concrete derived class as shown in subsequent sections.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><a class="code hl_class" href="class_drv_1_1_ip_socket.html">Drv::IpSocket</a>&amp; socket = ...; <span class="comment">// Initialize the component</span></div>
<div class="line">socket.<a class="code hl_function" href="class_drv_1_1_ip_socket.html#a98a57bf24cdeb8673be4780a8be2db55">configure</a>(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, 60210, 0, 100); <span class="comment">// Use 127.0.0.1:60210 with a 100us send timeout</span></div>
<div class="line">...</div>
<div class="line">socket.open();</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (chatting) {</div>
<div class="line">    socket.<a class="code hl_function" href="class_drv_1_1_ip_socket.html#a8d65fc4ff1e8ea229361b7f025d3520b">send</a>(); <span class="comment">// Timeout of 100us</span></div>
<div class="line">    socket.<a class="code hl_function" href="class_drv_1_1_ip_socket.html#ad7e8fbe0b5779b35548173c6fd62fdae">recv</a>(); <span class="comment">// Will block</span></div>
<div class="line">}</div>
<div class="line">socket.<a class="code hl_function" href="class_drv_1_1_ip_socket.html#a083d68f288494c9ffef7a789f846c6bc">close</a>();</div>
<div class="line">socket.<a class="code hl_function" href="class_drv_1_1_ip_socket.html#aeed642d83d6e65344cc6e4db43f2bc5a">open</a>();</div>
<div class="line">...</div>
<div class="ttc" id="aclass_drv_1_1_ip_socket_html"><div class="ttname"><a href="class_drv_1_1_ip_socket.html">Drv::IpSocket</a></div><div class="ttdoc">Helper base-class for setting up Berkeley sockets.</div><div class="ttdef"><b>Definition</b> <a href="_ip_socket_8hpp_source.html#l00047">IpSocket.hpp:47</a></div></div>
<div class="ttc" id="aclass_drv_1_1_ip_socket_html_a083d68f288494c9ffef7a789f846c6bc"><div class="ttname"><a href="class_drv_1_1_ip_socket.html#a083d68f288494c9ffef7a789f846c6bc">Drv::IpSocket::close</a></div><div class="ttdeci">void close()</div><div class="ttdoc">closes the socket</div><div class="ttdef"><b>Definition</b> <a href="_ip_socket_8cpp_source.html#l00124">IpSocket.cpp:124</a></div></div>
<div class="ttc" id="aclass_drv_1_1_ip_socket_html_a8d65fc4ff1e8ea229361b7f025d3520b"><div class="ttname"><a href="class_drv_1_1_ip_socket.html#a8d65fc4ff1e8ea229361b7f025d3520b">Drv::IpSocket::send</a></div><div class="ttdeci">SocketIpStatus send(const U8 *const data, const U32 size)</div><div class="ttdoc">send data out the IP socket from the given buffer</div><div class="ttdef"><b>Definition</b> <a href="_ip_socket_8cpp_source.html#l00169">IpSocket.cpp:169</a></div></div>
<div class="ttc" id="aclass_drv_1_1_ip_socket_html_a98a57bf24cdeb8673be4780a8be2db55"><div class="ttname"><a href="class_drv_1_1_ip_socket.html#a98a57bf24cdeb8673be4780a8be2db55">Drv::IpSocket::configure</a></div><div class="ttdeci">SocketIpStatus configure(const char *hostname, const U16 port, const U32 send_timeout_seconds, const U32 send_timeout_microseconds)</div><div class="ttdoc">configure the ip socket with host and transmission timeouts</div><div class="ttdef"><b>Definition</b> <a href="_ip_socket_8cpp_source.html#l00053">IpSocket.cpp:53</a></div></div>
<div class="ttc" id="aclass_drv_1_1_ip_socket_html_ad7e8fbe0b5779b35548173c6fd62fdae"><div class="ttname"><a href="class_drv_1_1_ip_socket.html#ad7e8fbe0b5779b35548173c6fd62fdae">Drv::IpSocket::recv</a></div><div class="ttdeci">SocketIpStatus recv(U8 *const data, U32 &amp;size)</div><div class="ttdoc">receive data from the IP socket from the given buffer</div><div class="ttdef"><b>Definition</b> <a href="_ip_socket_8cpp_source.html#l00208">IpSocket.cpp:208</a></div></div>
<div class="ttc" id="aclass_drv_1_1_ip_socket_html_aeed642d83d6e65344cc6e4db43f2bc5a"><div class="ttname"><a href="class_drv_1_1_ip_socket.html#aeed642d83d6e65344cc6e4db43f2bc5a">Drv::IpSocket::open</a></div><div class="ttdeci">SocketIpStatus open()</div><div class="ttdoc">open the IP socket for communications</div><div class="ttdef"><b>Definition</b> <a href="_ip_socket_8cpp_source.html#l00149">IpSocket.cpp:149</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md588"></a>
Drv::TcpClientSocket Class</h2>
<p>The <a class="el" href="class_drv_1_1_tcp_client_socket.html" title="Helper for setting up Tcp using Berkeley sockets as a client.">Drv::TcpClientSocket</a> class represents an IPv4 TCP client. It inherently provides bidirectional communication with a remote server tcp server. TCP communications acknowledge transmissions so the remote server will have received a message or this client will return an error. In other words, dropped packets will cause an error. Usage is as stipulated above and an example instantiation is shown below.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><a class="code hl_class" href="class_drv_1_1_ip_socket.html">Drv::IpSocket</a>&amp; socket = <a class="code hl_class" href="class_drv_1_1_tcp_client_socket.html">Drv::TcpClientSocket</a>;</div>
<div class="ttc" id="aclass_drv_1_1_tcp_client_socket_html"><div class="ttname"><a href="class_drv_1_1_tcp_client_socket.html">Drv::TcpClientSocket</a></div><div class="ttdoc">Helper for setting up Tcp using Berkeley sockets as a client.</div><div class="ttdef"><b>Definition</b> <a href="_tcp_client_socket_8hpp_source.html#l00026">TcpClientSocket.hpp:26</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md589"></a>
Drv::TcpServerSocket Class</h2>
<p>The <a class="el" href="class_drv_1_1_tcp_server_socket.html" title="Helper for setting up Tcp using Berkeley sockets as a server.">Drv::TcpServerSocket</a> class represents an IPv4 TCP server. It inherently provides bidirectional communication with a remote tcp client server. The TCP server must be started up such that it may listen for incoming client requests. Since this class is intended to communicate with exactly one client, no listen queue is provided and subsequent connects from clients will be ignored until the primary client has been closed. Like the TCP client packet drops will result in an error.</p>
<p><b>Note:</b> the <code><a class="el" href="class_drv_1_1_ip_socket.html#aeed642d83d6e65344cc6e4db43f2bc5a" title="open the IP socket for communications">Drv::TcpServerSocket::open</a></code> call will block until a client connects to the server.</p>
<p>In order to startup the server to listen, the <code><a class="el" href="class_drv_1_1_tcp_server_socket.html#afecec02b937dab1023598aa8e49a204b" title="Opens the server socket and listens, does not block.">Drv::TcpServerSocket::startup</a></code> method should be called. It will create a socket that will listen for incoming connections. <code><a class="el" href="class_drv_1_1_tcp_server_socket.html#afecec02b937dab1023598aa8e49a204b" title="Opens the server socket and listens, does not block.">Drv::TcpServerSocket::startup</a></code> should be called before any <code><a class="el" href="class_drv_1_1_ip_socket.html#aeed642d83d6e65344cc6e4db43f2bc5a" title="open the IP socket for communications">Drv::TcpServerSocket::open</a></code> calls to ensure that the server is ready for communication. <code><a class="el" href="class_drv_1_1_ip_socket.html#a083d68f288494c9ffef7a789f846c6bc" title="closes the socket">Drv::TcpServerSocket::close</a></code> will only close the client connection and does not affect the server from listening for clients, however; it does free up the server to accept a new client.</p>
<p><code><a class="el" href="class_drv_1_1_tcp_server_socket.html#a64041db311adb6592590d996741da6c6" title="Shutdown and close the server socket followed by the open client.">Drv::TcpServerSocket::shutdown</a></code> will close the TCP server from receiving any new clients and effectively releases all resources allocated to the server. <code><a class="el" href="class_drv_1_1_tcp_server_socket.html#a64041db311adb6592590d996741da6c6" title="Shutdown and close the server socket followed by the open client.">Drv::TcpServerSocket::shutdown</a></code> implies <code><a class="el" href="class_drv_1_1_ip_socket.html#a083d68f288494c9ffef7a789f846c6bc" title="closes the socket">Drv::TcpServerSocket::close</a></code> and client connections will be stopped.</p>
<h2><a class="anchor" id="autotoc_md590"></a>
Example TcpServer Usage</h2>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><a class="code hl_class" href="class_drv_1_1_tcp_server_socket.html">Drv::TcpServerSocket</a>&amp; server = <a class="code hl_namespace" href="namespace_drv.html">Drv</a>::; <span class="comment">// Initialize the component</span></div>
<div class="line">server.<a class="code hl_function" href="class_drv_1_1_ip_socket.html#a98a57bf24cdeb8673be4780a8be2db55">configure</a>(<span class="stringliteral">&quot;127.0.0.1&quot;</span>, 60210, 0, 100); <span class="comment">// Use 127.0.0.1:60210 with a 100us send timeout</span></div>
<div class="line">...</div>
<div class="line">server.startup(); <span class="comment">// Listen on 127.0.0.1:60210</span></div>
<div class="line">server.<a class="code hl_function" href="class_drv_1_1_ip_socket.html#aeed642d83d6e65344cc6e4db43f2bc5a">open</a>(); <span class="comment">// Blocks until a client is available</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (chatting) {</div>
<div class="line">    server.<a class="code hl_function" href="class_drv_1_1_ip_socket.html#a8d65fc4ff1e8ea229361b7f025d3520b">send</a>(); <span class="comment">// Timeout of 100us</span></div>
<div class="line">    server.<a class="code hl_function" href="class_drv_1_1_ip_socket.html#ad7e8fbe0b5779b35548173c6fd62fdae">recv</a>(); <span class="comment">// Will block</span></div>
<div class="line">}</div>
<div class="line">server.<a class="code hl_function" href="class_drv_1_1_ip_socket.html#a083d68f288494c9ffef7a789f846c6bc">close</a>();</div>
<div class="line">server.<a class="code hl_function" href="class_drv_1_1_ip_socket.html#aeed642d83d6e65344cc6e4db43f2bc5a">open</a>(); <span class="comment">// Blocks until a client is available</span></div>
<div class="line">...</div>
<div class="line">server.shutdown();</div>
<div class="ttc" id="aclass_drv_1_1_tcp_server_socket_html"><div class="ttname"><a href="class_drv_1_1_tcp_server_socket.html">Drv::TcpServerSocket</a></div><div class="ttdoc">Helper for setting up Tcp using Berkeley sockets as a server.</div><div class="ttdef"><b>Definition</b> <a href="_tcp_server_socket_8hpp_source.html#l00026">TcpServerSocket.hpp:26</a></div></div>
<div class="ttc" id="anamespace_drv_html"><div class="ttname"><a href="namespace_drv.html">Drv</a></div><div class="ttdef"><b>Definition</b> <a href="_block_driver_8hpp_source.html#l00011">BlockDriver.hpp:11</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md591"></a>
Drv::UdpSocket Class</h2>
<p>The <a class="el" href="class_drv_1_1_udp_socket.html" title="Helper for setting up Udp using Berkeley sockets as a client.">Drv::UdpSocket</a> class represents an IPv4 UDP sender/receiver. <a class="el" href="class_drv_1_1_udp_socket.html" title="Helper for setting up Udp using Berkeley sockets as a client.">Drv::UdpSocket</a> will provide unidirectional or bidirectional communication using UDP. UDP is typically faster than TCP as it does not acknowledge transmissions. There is no guarantee that a sent packet is received, or even that the remote side is listening.</p>
<p>A udp socket must be configured for each direction that it will communicate in. This can be done using calls to <code><a class="el" href="class_drv_1_1_udp_socket.html#ac4fb848a78dfcdaced8a064b11d27332" title="configure the udp socket for outgoing transmissions">Drv::UdpSocket::configureSend</a></code> and <code><a class="el" href="class_drv_1_1_udp_socket.html#a8f47149416063e23b273c94009920ed3" title="configure the udp socket for incoming transmissions">Drv::UdpSocket::configureRecv</a></code>. If either call is omitted only a single direction of communication will function. It is erroneous to omit both configuration calls. Calling <code><a class="el" href="class_drv_1_1_ip_socket.html#a98a57bf24cdeb8673be4780a8be2db55" title="configure the ip socket with host and transmission timeouts">Drv::UdpSocket::configure</a></code> is equivalent to calling <code><a class="el" href="class_drv_1_1_udp_socket.html#ac4fb848a78dfcdaced8a064b11d27332" title="configure the udp socket for outgoing transmissions">Drv::UdpSocket::configureSend</a></code> for compatibility with <code><a class="el" href="class_drv_1_1_ip_socket.html" title="Helper base-class for setting up Berkeley sockets.">Drv::IpSocket</a></code>. Other interaction with the UDP socket is as stipulated with <code><a class="el" href="class_drv_1_1_ip_socket.html" title="Helper base-class for setting up Berkeley sockets.">Drv::IpSocket</a></code>. Examples of instantiation and configuration are provided below.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><a class="code hl_class" href="class_drv_1_1_udp_socket.html">Drv::UdpSocket</a>&amp; socketSend = <a class="code hl_class" href="class_drv_1_1_udp_socket.html">Drv::UdpSocket</a>;</div>
<div class="line">socketSend.<a class="code hl_function" href="class_drv_1_1_udp_socket.html#ac4fb848a78dfcdaced8a064b11d27332">configureSend</a>(127.0.0.1, 60211, 0, 100); <span class="comment">// Send only socket</span></div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">Drv::UdpSocket&amp; socketRecv = <a class="code hl_class" href="class_drv_1_1_udp_socket.html">Drv::UdpSocket</a>;</div>
<div class="line">socketRecv.<a class="code hl_function" href="class_drv_1_1_udp_socket.html#a8f47149416063e23b273c94009920ed3">configureRecv</a>(127.0.0.1, 60212); <span class="comment">// Receive only socket</span></div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">Drv::UdpSocket&amp; socketBoth = <a class="code hl_class" href="class_drv_1_1_udp_socket.html">Drv::UdpSocket</a>;</div>
<div class="line">socketBoth.<a class="code hl_function" href="class_drv_1_1_udp_socket.html#ac4fb848a78dfcdaced8a064b11d27332">configureSend</a>(127.0.0.1, 60211, 0, 100);</div>
<div class="line">socketBoth.configureRecv(127.0.0.1, 60212);</div>
<div class="line">...</div>
<div class="ttc" id="aclass_drv_1_1_udp_socket_html"><div class="ttname"><a href="class_drv_1_1_udp_socket.html">Drv::UdpSocket</a></div><div class="ttdoc">Helper for setting up Udp using Berkeley sockets as a client.</div><div class="ttdef"><b>Definition</b> <a href="_udp_socket_8hpp_source.html#l00032">UdpSocket.hpp:32</a></div></div>
<div class="ttc" id="aclass_drv_1_1_udp_socket_html_a8f47149416063e23b273c94009920ed3"><div class="ttname"><a href="class_drv_1_1_udp_socket.html#a8f47149416063e23b273c94009920ed3">Drv::UdpSocket::configureRecv</a></div><div class="ttdeci">SocketIpStatus configureRecv(const char *hostname, const U16 port)</div><div class="ttdoc">configure the udp socket for incoming transmissions</div><div class="ttdef"><b>Definition</b> <a href="_udp_socket_8cpp_source.html#l00069">UdpSocket.cpp:69</a></div></div>
<div class="ttc" id="aclass_drv_1_1_udp_socket_html_ac4fb848a78dfcdaced8a064b11d27332"><div class="ttname"><a href="class_drv_1_1_udp_socket.html#ac4fb848a78dfcdaced8a064b11d27332">Drv::UdpSocket::configureSend</a></div><div class="ttdeci">SocketIpStatus configureSend(const char *hostname, const U16 port, const U32 send_timeout_seconds, const U32 send_timeout_microseconds)</div><div class="ttdoc">configure the udp socket for outgoing transmissions</div><div class="ttdef"><b>Definition</b> <a href="_udp_socket_8cpp_source.html#l00062">UdpSocket.cpp:62</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md592"></a>
Drv::SocketReadTask Virtual Baseclass</h2>
<p>The <a class="el" href="class_drv_1_1_socket_read_task.html" title="supports a task to read a given socket adaptation">Drv::SocketReadTask</a> is intended as a base class used to add in the functionality of an automatically reconnecting receive thread to another class (typically an F´ component). In order for this thread to function, the inheritor must implement several methods to provide the necessary interaction of this thread. These functions are described in the next section.</p>
<p>In order to start the receiving thread a call to the <code>Drv::SocketReadTask::startSocketTask</code> method is performed passing in a name, and all arguments to <code><a class="el" href="class_os_1_1_task.html#adf42d4bb8ec737eb1755607e8919912c" title="start the task">Os::Task::start</a></code> to start the task. An optional parameter, reconnect, will determine if this read task will reconnect to sockets should a disconnect or error occur. Once started the read task will continue until a <code>Drv::SocketReadTask::stopSocketTask</code> has been called or an error occurred when started without reconnect set to <code>true</code>. Once the socket stop call has been made, the user should call <code>Drv::SocketReadTask::joinSocketTask</code> in order to wait until the full task has finished. <code>Drv::SocketReadTask::stopSocketTask</code> will call <code><a class="el" href="class_drv_1_1_ip_socket.html#a083d68f288494c9ffef7a789f846c6bc" title="closes the socket">Drv::IpSocket::close</a></code> on the provided <a class="el" href="class_drv_1_1_ip_socket.html" title="Helper base-class for setting up Berkeley sockets.">Drv::IpSocket</a> to ensure that any blocking reads exit freeing the thread to completely stop. Normal usage of a <a class="el" href="class_drv_1_1_socket_read_task.html" title="supports a task to read a given socket adaptation">Drv::SocketReadTask</a> derived class is shown below.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><a class="code hl_class" href="class_os_1_1_task_string.html">Os::TaskString</a> name(<span class="stringliteral">&quot;ReceiveTask&quot;</span>);</div>
<div class="line">uplinkComm.startSocketTask(name); <span class="comment">// Default reconnect=true</span></div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">uplinkComm.stopSocketTask();</div>
<div class="line">(void) uplinkComm.joinSocketTask(<span class="keyword">nullptr</span>);</div>
<div class="ttc" id="aclass_os_1_1_task_string_html"><div class="ttname"><a href="class_os_1_1_task_string.html">Os::TaskString</a></div><div class="ttdef"><b>Definition</b> <a href="_task_string_8hpp_source.html#l00016">TaskString.hpp:16</a></div></div>
</div><!-- fragment --><p><code><a class="el" href="class_drv_1_1_socket_read_task.html#abae0c4c62dbebd9c2e418b49c2760561" title="open the socket for communications">Drv::SocketReadTask::open</a></code> and <code><a class="el" href="class_drv_1_1_socket_read_task.html#a3e99c88eed967c35990a122539eed249" title="close the socket communications">Drv::SocketReadTask::close</a></code> convenience methods are also provided to open and close the provided <a class="el" href="class_drv_1_1_ip_socket.html" title="Helper base-class for setting up Berkeley sockets.">Drv::IpSocket</a>, although it should be noted that both are called automatically during the normal process of the receive thread.</p>
<h3><a class="anchor" id="autotoc_md593"></a>
Drv::SocketReadTask Inheritance</h3>
<p><a class="el" href="class_drv_1_1_socket_read_task.html" title="supports a task to read a given socket adaptation">Drv::SocketReadTask</a> is used via inheritance. A class that needs to provide receive thread functionality may inherit from this class and implement the three virtual methods to integrate with the thread. These methods are described below and each provides its prototype.</p>
<p><code><a class="el" href="class_drv_1_1_socket_read_task.html#a1ec21cc359afd96a8c2124f69dfc618d" title="returns a reference to the socket handler">Drv::SocketReadTask::getSocketHandler</a></code> returns a reference to an existing <a class="el" href="class_drv_1_1_ip_socket.html" title="Helper base-class for setting up Berkeley sockets.">Drv::IpSocket</a> for this task to interact with for receiving, sending, opening, and closing. This should not be allocated within the function call as it will be used outside the call. The instance is expected to have been configured and started (in the case of servers). The prototype of the function is shown below.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">virtual</span> IpSocket&amp; getSocketHandler() = 0;</div>
</div><!-- fragment --><p><code><a class="el" href="class_drv_1_1_socket_read_task.html#a3a74bde5c804e6816d3d015cef74f31d" title="returns a buffer to fill with data">Drv::SocketReadTask::getBuffer</a></code> returns an <a class="el" href="class_fw_1_1_buffer.html">Fw::Buffer</a> instance that wraps data for the read call to fill. This can wrap stack memory, or delegate the call to a buffer manager instance. This buffer will be returned via a call to <code><a class="el" href="class_drv_1_1_socket_read_task.html#abc94a3b38263cbc7bb5339166e547bc7" title="sends a buffer to be filled with data">Drv::SocketReadTask::sendBuffer</a></code> once the received data has filled it. The prototype of the function is shown below.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">virtual</span> <a class="code hl_class" href="class_fw_1_1_buffer.html">Fw::Buffer</a> getBuffer() = 0;</div>
<div class="ttc" id="aclass_fw_1_1_buffer_html"><div class="ttname"><a href="class_fw_1_1_buffer.html">Fw::Buffer</a></div><div class="ttdef"><b>Definition</b> <a href="_buffer_8hpp_source.html#l00043">Buffer.hpp:43</a></div></div>
</div><!-- fragment --><p><code><a class="el" href="class_drv_1_1_socket_read_task.html#abc94a3b38263cbc7bb5339166e547bc7" title="sends a buffer to be filled with data">Drv::SocketReadTask::sendBuffer</a></code> returns the buffer obtained from <code><a class="el" href="class_drv_1_1_socket_read_task.html#a3a74bde5c804e6816d3d015cef74f31d" title="returns a buffer to fill with data">Drv::SocketReadTask::getBuffer</a></code> after it has been filled with data read from the socket. This will come with a status associated with the read but will always be called such that the allocated buffer can be freed when needed.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">virtual</span> <span class="keywordtype">void</span> sendBuffer(<a class="code hl_class" href="class_fw_1_1_buffer.html">Fw::Buffer</a> buffer, SocketIpStatus status) = 0;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md594"></a>
Further Information</h2>
<p>Further information can be read by referencing the following components.</p>
<p><code>Drv::TcpClientComponent</code>: a F´ component wrapper of the tcp client <code>Drv::TcpServerComponent</code>: a F´ component wrapper of the tcp server <code>Drv::UdpComponent</code>: a F´ component wrapper of the udp </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="_drv.html">Drv Components and Classes</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
