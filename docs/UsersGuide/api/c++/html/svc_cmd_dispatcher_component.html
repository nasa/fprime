<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>F´ Flight Software - C/C++ Documentation: Svc::CmdDispatcher Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">F´ Flight Software - C/C++ Documentation
   &#160;<span id="projectnumber">Latest</span>
   </div>
   <div id="projectbrief">A framework for building embedded system applications to NASA flight quality standards.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_svc_cmd_dispatcher_component.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Svc::CmdDispatcher Component </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md275"></a>
Svc::CmdDispatcher Component</h1>
<h2><a class="anchor" id="autotoc_md276"></a>
1. Introduction</h2>
<p>The <code>Svc::CmdDispatcher</code> is responsible for dispatching incoming commands to the components that implement those commands. The commands are sent in encoded <code>Fw::Com</code> form from an external sender like a ground system or a sequencer. The dispatcher decodes the packet and extracts the opcode. This opcode is looked up in a table and dispatched to the component via a port indicated in the table. The output port for each opcode is set by a call to a registration port.</p>
<h2><a class="anchor" id="autotoc_md277"></a>
2. Requirements</h2>
<p>The requirements for <code>Svc::CmdDispatcher</code> are as follows:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Requirement   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Verification Method    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CD-001   </td><td class="markdownTableBodyNone">The <code>Svc::CmdDispatcher</code> component shall accept command buffers and decode them into commands   </td><td class="markdownTableBodyNone">Inspection, Unit Test    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">CD-002   </td><td class="markdownTableBodyNone">The <code>Svc::CmdDispatcher</code> component shall dispatch commands to components   </td><td class="markdownTableBodyNone">Unit Test    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CD-003   </td><td class="markdownTableBodyNone">The <code>Svc::CmdDispatcher</code> component shall provide an interface to register commands   </td><td class="markdownTableBodyNone">Inspection    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">CD-004   </td><td class="markdownTableBodyNone">The <code>Svc::CmdDispatcher</code> component shall process command status from components and report the results to the command buffer sender.   </td><td class="markdownTableBodyNone">Unit Test   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md278"></a>
3. Design</h2>
<h3><a class="anchor" id="autotoc_md279"></a>
3.1 Context</h3>
<h4><a class="anchor" id="autotoc_md280"></a>
3.1.1 Component Diagram</h4>
<p>The <code>Svc::CmdDispatcher</code> component has the following component diagram:</p>
<p><img src="img/CommandDispatcherBDD.jpg" alt="`Svc::CmdDispatcher` Diagram" title="Svc::CmdDispatcher" class="inline"/></p>
<h4><a class="anchor" id="autotoc_md281"></a>
3.1.2 Ports</h4>
<p>The <code>Svc::CmdDispatcher</code> component uses the following port types:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Port Data Type   </th><th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Direction   </th><th class="markdownTableHeadNone">Kind   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="../../../Fw/Cmd/docs/sdd.html"><code>Fw::Cmd</code></a>   </td><td class="markdownTableBodyNone">cmdSend   </td><td class="markdownTableBodyNone">Output   </td><td class="markdownTableBodyNone">n/a   </td><td class="markdownTableBodyNone">Send commands to components    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="../../../Fw/Cmd/docs/sdd.html"><code>Fw::CmdResponse</code></a>   </td><td class="markdownTableBodyNone">compStat   </td><td class="markdownTableBodyNone">Input   </td><td class="markdownTableBodyNone">Asynchronous   </td><td class="markdownTableBodyNone">Port for components to report command status    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="../../../Fw/Cmd/docs/sdd.html"><code>Fw::CmdResponse</code></a>   </td><td class="markdownTableBodyNone">seqStatus   </td><td class="markdownTableBodyNone">Output   </td><td class="markdownTableBodyNone">n/a   </td><td class="markdownTableBodyNone">Send command status to command buffer source    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="../../../Fw/Com/docs/sdd.html"><code>Fw::Com</code></a>   </td><td class="markdownTableBodyNone">cmdBuff   </td><td class="markdownTableBodyNone">Input   </td><td class="markdownTableBodyNone">Asynchronous   </td><td class="markdownTableBodyNone">Receive command buffer    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="../../../Fw/Cmd/docs/sdd.html"><code>Fw::CmdReg</code></a>   </td><td class="markdownTableBodyNone">cmdReg   </td><td class="markdownTableBodyNone">Input   </td><td class="markdownTableBodyNone">Synchronous   </td><td class="markdownTableBodyNone">Command Registration   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md282"></a>
3.2 Functional Description</h3>
<p>The <code>Svc::CmdDispatcher</code> component provides command dispatching. The architecture autocoder generates port instances for components that specify commands that implement the commanding pattern. <code><a class="el" href="namespace_svc.html#a37fd952fb3d9eb282aa3e879f7571726">Svc::CommandDispatcher</a></code> implements the command decoding and dispatching to supply the components with commands.</p>
<h4><a class="anchor" id="autotoc_md283"></a>
3.2.1 Command Registration</h4>
<p>An autogenerated function on components create a public function <code>regCommands</code> that tells components to register the set of op codes that are implemented by the component. The autogenerated port is connected to the <code>compCmdReg</code> input port on <code>Svc::CmdDispatcher</code> that corresponds to the number of the <code>compCmdSend</code> port used to dispatch commands. The port handler looks through the dispatch table for an unused entry and adds the opcode. It maps the opcode to the dispatch port number corresponding to the registration port number.</p>
<h4><a class="anchor" id="autotoc_md284"></a>
3.2.2 Command Dispatch</h4>
<p>When the command dispatcher receives a command buffer, it decodes the opcode. It searches the dispatch table for the opcode, then assigns a sequence number to the command and stores the opcode, sequence number, context value and source port in a pending command table. The command is then dispatched to the component that implements the command. When the component completes execution of the command, it reports the status back via the <code>compStat</code> port. The sequence number is matched to the entry in the pending command table, and the <code>seqStatus</code> output port corresponding to the source port is called (if it is connected) with the status and the context value. Note that this requires that the component sending the command buffer have connections to the same <code>cmdBuff</code> and <code>seqStatus</code> port numbers.</p>
<h3><a class="anchor" id="autotoc_md285"></a>
3.3 Scenarios</h3>
<h4><a class="anchor" id="autotoc_md286"></a>
3.3.1 Command Registration</h4>
<p>The <code>Svc::CmdDispatcher</code> component accepts command registration from other components:</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    Initialization-&gt;&gt;Component: get_ComdReg_InputPort()</div>
<div class="line">    activate Initialization</div>
<div class="line">    deactivate Initialization</div>
<div class="line">    activate Component</div>
<div class="line">    deactivate Component</div>
<div class="line">    Initialization-&gt;&gt;Component: regCommands()</div>
<div class="line">    activate Initialization</div>
<div class="line">    activate Component</div>
<div class="line">    loop for each opcode</div>
<div class="line">        Component-&gt;&gt;CommandDispatcher: cmdReg()</div>
<div class="line">    end</div>
<div class="line">    deactivate Initialization</div>
<div class="line">    deactivate Component</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md287"></a>
3.3.1 Dispatch Commands</h4>
<p>The <code>Svc::CmdDispatcher</code> component dispatches commands to other components:</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    Command Buffer Source-&gt;&gt;CommandDispatcher: cmdBuff()</div>
<div class="line">    activate Command Buffer Source</div>
<div class="line">    activate CommandDispatcher</div>
<div class="line">    CommandDispatcher-&gt;&gt;Component: cmdBuff()</div>
<div class="line">    activate Component</div>
<div class="line">    Component-&gt;&gt;CommandDispatcher: comStat()</div>
<div class="line">    deactivate Component</div>
<div class="line">    CommandDispatcher-&gt;&gt;Command Buffer Source: seqStatus()</div>
<div class="line">    deactivate CommandDispatcher</div>
<div class="line">    deactivate Command Buffer Source</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md288"></a>
3.4 State</h3>
<p><code>Svc::CmdDispatcher</code> has no state machines.</p>
<h3><a class="anchor" id="autotoc_md289"></a>
3.5 Algorithms</h3>
<p><code>Svc::CmdDispatcher</code> has no significant algorithms.</p>
<h2><a class="anchor" id="autotoc_md290"></a>
4. Dictionary</h2>
<p>Dictionaries: <a href="CmdDispatcher.html">HTML</a></p>
<h2><a class="anchor" id="autotoc_md291"></a>
4. Module Checklists</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Document   </th><th class="markdownTableHeadNone">Link    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Design Checklist   </td><td class="markdownTableBodyNone"><a href="Checklist_Design.xlsx">Link</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Code Checklist   </td><td class="markdownTableBodyNone"><a href="Checklist_Code.xlsx">Link</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Unit Test Checklist   </td><td class="markdownTableBodyNone"><a href="Checklist_Unit_Test.xls">Link</a>   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md292"></a>
5. Unit Testing</h2>
<p>To see unit test coverage run <code>fprime-util check --coverage</code></p>
<h2><a class="anchor" id="autotoc_md293"></a>
6. Change Log</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">6/25/2015   </td><td class="markdownTableBodyNone">Design review edits    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">7/22/2015   </td><td class="markdownTableBodyNone">Design review actions    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">9/16/2015   </td><td class="markdownTableBodyNone">Unit Test additions    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1/28/2016   </td><td class="markdownTableBodyNone">Added context value discussion    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">5/17/2021   </td><td class="markdownTableBodyNone">Added CMD Reregistration option   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="svc.html">Svc Components, Ports, and Classes</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
