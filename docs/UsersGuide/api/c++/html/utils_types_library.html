<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>F´ Flight Software - C/C++ Documentation: Utils::Types Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">F´ Flight Software - C/C++ Documentation
   &#160;<span id="projectnumber">devel</span>
   </div>
   <div id="projectbrief">A framework for building embedded system applications to NASA flight quality standards.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_utils_types_library.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Utils::Types Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1154"></a>
Utils/Types</h1>
<p>This directory contains a library of helper types.</p>
<h2><a class="anchor" id="autotoc_md1155"></a>
Circular Buffer</h2>
<p>This type uses a circular buffer to implement a bounded FIFO stream, i.e., a logical store that can grow to a maximum size and can shrink. The logical store is byte addressable with addresses 0 through <em>n - 1</em>, where <em>n</em> is the current store size. It grows by increasing the top address from <em>n - 1</em> to <em>n + m - 1</em> and copying <em>m</em> bytes of data into the logical memory so allocated. It shrinks by deleting the lowest <em>m</em> addresses and renumbering the logical addresses of the remaining bytes starting at zero.</p>
<p>The implementation uses a fixed-size physical store. The logical store is represented as a base or head index into the physical store and an allocated size. Initially both are zero. When data is added to the circular buffer, the allocated size grows. When data is removed from the circular buffer, the allocated size shrinks, and the head pointer advances.</p>
<p>The allocated store size never exceeds the physical store size. However, when the head index is greater than zero, the sum of the head index and the allocated size may exceed the physical store size. In this case, the logical store wraps around to the beginning of the physical store. Further, deleting data while in this state may cause the head index to wrap around.</p>
<p><code>CircularBuffer</code> does not provide concurrency control. If multiple threads use the buffer, the uses must be guarded by other concurrency control, e.g., a queue or lock.</p>
<p>The <code>CircularBuffer</code> type provides the following operations.</p>
<h3><a class="anchor" id="autotoc_md1156"></a>
Constructor</h3>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">CircularBuffer(U8* const buffer, const NATIVE_UINT_TYPE size)</div>
</div><!-- fragment --><p>Construct a circular buffer with the given physical store, specified as a starting pointer and a size in bytes.</p>
<h3><a class="anchor" id="autotoc_md1157"></a>
Adding Data</h3>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">Fw::SerializeStatus serialize(const U8* const buffer, const NATIVE_UINT_TYPE size);</div>
</div><!-- fragment --><p>If the current logical store size plus <code>size</code> exceeds the maximum logical store size, then return an error. Otherwise increase the logical store size by <code>size</code> bytes and copy <code>size</code> bytes starting at <code>buffer</code> into the new logical memory.</p>
<p>The operation is called <code>serialize</code> following F Prime practice. No data is actually serialized (the data is copied byte for byte).</p>
<h3><a class="anchor" id="autotoc_md1158"></a>
Reading Data</h3>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">Fw::SerializeStatus peek(char&amp; value, NATIVE_UINT_TYPE offset = 0) const;</div>
</div><!-- fragment --><p>If <code>offset</code> is not a valid address of the logical store, then return an error. Otherwise read a <code>char</code> value at address <code>offset</code> of the logical store and store the result into <code>value</code>.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">Fw::SerializeStatus peek(U8&amp; value, NATIVE_UINT_TYPE offset = 0) const;</div>
</div><!-- fragment --><p>Same as previous, but read a <code>U8</code> value.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">Fw::SerializeStatus peek(U32&amp; value, NATIVE_UINT_TYPE offset = 0) const;</div>
</div><!-- fragment --><p>If <code>offset</code> through <code>offset</code> + 3 are not valid addresses in the logical store, then return an error. Otherwise read four bytes of the logical store starting at <code>offset</code>, interpret them as an unsigned 32-bit integer in big endian order, and store the result into <code>value</code>.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">Fw::SerializeStatus peek(U8* buffer, NATIVE_UINT_TYPE size, NATIVE_UINT_TYPE offset = 0) const;</div>
</div><!-- fragment --><p>If <code>offset</code> through <code>offset + size - 1</code> are not all valid addresses in the logical store, then return an error. Otherwise copy <code>size</code> bytes starting at <code>offset</code> into the memory starting at <code>buffer</code>.</p>
<h3><a class="anchor" id="autotoc_md1159"></a>
Deleting Data</h3>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">Fw::SerializeStatus rotate(NATIVE_UINT_TYPE amount);</div>
</div><!-- fragment --><p>If the logical store size <em>s</em> is less than <code>amount</code>, then return an error. Otherwise delete <code>amount</code> bytes from the bottom of the logical store: reassign the bytes at addresses <code>amount</code> through <em>s</em> - 1 to addresses zero through <em>s</em> - <code>amount</code> - 1, and set the logical store size to <em>s</em> - <code>amount</code>.</p>
<h3><a class="anchor" id="autotoc_md1160"></a>
Querying Buffer State</h3>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">NATIVE_UINT_TYPE get_allocated_size() const;</div>
</div><!-- fragment --><p>Return the number of allocated bytes, i.e., the current logical store size. This is the maximum number of bytes that may be read from the logical store without adding data.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">NATIVE_UINT_TYPE get_free_size() const;</div>
</div><!-- fragment --><p>Return the number of free bytes, i.e., the maximum logical store size minus the current logical store size. This is the number of bytes that may be added to the logical store without deleting data.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">NATIVE_UINT_TYPE get_capacity() const;</div>
</div><!-- fragment --><p>Return the maximum logical store size (equal to the physical store size). This is the total number of bytes that may be added to an empty circular buffer. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="utils.html">Utils Classes</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
