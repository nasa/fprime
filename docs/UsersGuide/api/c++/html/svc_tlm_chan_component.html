<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>F´ Flight Software - C/C++ Documentation: Svc::TlmChan Component</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">F´ Flight Software - C/C++ Documentation
   &#160;<span id="projectnumber">Latest</span>
   </div>
   <div id="projectbrief">A framework for building embedded system applications to NASA flight quality standards.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_svc_tlm_chan_component.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a> Component </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md640"></a>
Svc::TlmChan Component</h1>
<h2><a class="anchor" id="autotoc_md641"></a>
1. Introduction</h2>
<p>The <code><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a></code> Component is used to store telemetry values written by other components. The values are stored in serialized form. The data is stored as a set of telemetry channels in a table. The data can be individually read back or periodically pushed to another component for transporting out of the system. <code><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a></code> is an implementation of the <code>Svc::TlmStore</code> component in the <code>Svc/Tlm</code> directory.</p>
<h2><a class="anchor" id="autotoc_md642"></a>
2. Requirements</h2>
<p>The requirements for <code><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a></code> are as follows:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Requirement   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Verification Method    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TLC-001   </td><td class="markdownTableBodyNone">The <code><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a></code> component shall provide an interface to submit telemetry   </td><td class="markdownTableBodyNone">Unit Test    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TLC-002   </td><td class="markdownTableBodyNone">The <code><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a></code> component shall provide an interface to read telemetry   </td><td class="markdownTableBodyNone">Unit Test    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TLC-003   </td><td class="markdownTableBodyNone">The <code><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a></code> component shall provide an interface to run periodically to write telemetry   </td><td class="markdownTableBodyNone">Unit Test    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TLC-004   </td><td class="markdownTableBodyNone">The <code><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a></code> component shall write changed telemetry channels when invoked by the run port   </td><td class="markdownTableBodyNone">Unit Test   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md643"></a>
3. Design</h2>
<h3><a class="anchor" id="autotoc_md644"></a>
3.1 Context</h3>
<h4><a class="anchor" id="autotoc_md645"></a>
3.1.1 Component Diagram</h4>
<p>The <code><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a></code> component has the following component diagram:</p>
<p><img src="img/TlmChanBDD.jpg" alt="Svc::TlmChan Diagram" title="Svc::TlmChan" class="inline"/></p>
<h4><a class="anchor" id="autotoc_md646"></a>
3.1.2 Ports</h4>
<p>The <code><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a></code> component uses the following port types:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Port Data Type   </th><th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Direction   </th><th class="markdownTableHeadNone">Kind   </th><th class="markdownTableHeadNone">Usage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="../../Sched/docs/sdd.html"><code>Svc::Sched</code></a>   </td><td class="markdownTableBodyNone">Run   </td><td class="markdownTableBodyNone">Input   </td><td class="markdownTableBodyNone">Asynchronous   </td><td class="markdownTableBodyNone">Execute a cycle to write changed telemetry channels    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="../../../Fw/Tlm/docs/sdd.html"><code>Fw::Tlm</code></a>   </td><td class="markdownTableBodyNone">TlmRecv   </td><td class="markdownTableBodyNone">Input   </td><td class="markdownTableBodyNone">Synchronous Input   </td><td class="markdownTableBodyNone">Update a telemetry channel    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="../../../Fw/Tlm/docs/sdd.html"><code>Fw::Tlm</code></a>   </td><td class="markdownTableBodyNone">TlmGet   </td><td class="markdownTableBodyNone">Input   </td><td class="markdownTableBodyNone">Synchronous Input   </td><td class="markdownTableBodyNone">Read a telemetry channel    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a href="../../../Fw/Com/docs/sdd.html"><code>Fw::Com</code></a>   </td><td class="markdownTableBodyNone">PktSend   </td><td class="markdownTableBodyNone">Output   </td><td class="markdownTableBodyNone">n/a   </td><td class="markdownTableBodyNone">Write a set of packets with updated telemetry   </td></tr>
</table>
<h4><a class="anchor" id="autotoc_md647"></a>
3.2 Functional Description</h4>
<p>The <code><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a></code> component has an input port <code>TlmRecv</code> that receives channel updates from other components in the system. These calls from the other components are made by the component implementation classes, but the generated code in the base classes takes the type specific channel value and serializes it, then makes the call to the output port. The <code><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a></code> component can then store the channel value as generic data. The channel values are stored in an internal double-buffered table, and a flag is set when a new value is written to the channel entry.</p>
<p>When a request is made for a nonexistent channel, the call will return with an empty buffer in the <a class="el" href="class_fw_1_1_tlm_buffer.html">Fw::TlmBuffer</a> value argument. This is to cover the case where a channel is defined in the system, but has not been written yet. If the channel has not ever been defined, there is no way to programmatically determine that from the TlmGet port call.</p>
<p>The implementation uses a hashing function that is tuned in the configuration file <code><a class="el" href="tlm_chan_impl_cfg_8hpp.html" title="Configuration file for Telemetry Channel component.">TlmChanImplCfg.hpp</a></code>. See section 3.5 for description.</p>
<h3><a class="anchor" id="autotoc_md648"></a>
3.3 Scenarios</h3>
<h4><a class="anchor" id="autotoc_md649"></a>
3.3.1 External User Option</h4>
<p>This diagram shows the scenario where telemetry packets are generated for an external user:</p>
<p><img src="img/ExternalUserScenario.jpg" alt="External User Scenario" class="inline"/></p>
<h4><a class="anchor" id="autotoc_md650"></a>
3.3.2 Telemetry Database Option</h4>
<p>This diagram shows the scenario where telemetry packets are stored and retrieved as a database:</p>
<p><img src="img/DatabaseScenario.jpg" alt="External User Scenario" class="inline"/></p>
<h3><a class="anchor" id="autotoc_md651"></a>
3.4 State</h3>
<p><code><a class="el" href="namespace_svc.html#afbbcedb62d0533e2557fdde783b06acf">Svc::TlmChan</a></code> has no state machines.</p>
<h3><a class="anchor" id="autotoc_md652"></a>
3.5 Algorithms</h3>
<p>In order to speed up lookups for storing and reading telemetry channels, a simple hash function is used to select a location in an array of hash table slots. A configuration value in <code>TlmChanImplCfg.h</code> defines a set of hash buckets to store the telemetry values. The number of buckets has to be at least as large as the number of telemetry values defined in the system. The number of channels in the system can be determined by invoking <code>make comp_report_gen</code> from the deployment directory. The number of has table slots <code>TLMCHAN_NUM_TLM_HASH_SLOTS</code> and the hash value <code>TLMCHAN_HASH_MOD_VALUE</code> in the configuration file can be varied to balance the amount of memory for slots versus the distribution of buckets to slots. See <code>TlmChanImplCfg.h</code> for a procedure on how to tune the algorithm.</p>
<h2><a class="anchor" id="autotoc_md653"></a>
4. Dictionaries</h2>
<p>TBD</p>
<h2><a class="anchor" id="autotoc_md654"></a>
5. Module Checklists</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Document   </th><th class="markdownTableHeadNone">Link    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Design Checklist   </td><td class="markdownTableBodyNone"><a href="Checklist_Design.xlsx">Link</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Code Checklist   </td><td class="markdownTableBodyNone"><a href="Checklist_Code.xlsx">Link</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Unit Test Checklist   </td><td class="markdownTableBodyNone"><a href="Checklist_Unit_Test.xlsx">Link</a>   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md655"></a>
6. Unit Testing</h2>
<p>To see unit test coverage run fprime-util check &ndash;coverage</p>
<h2><a class="anchor" id="autotoc_md656"></a>
7. Change Log</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">6/23/2015   </td><td class="markdownTableBodyNone">Design review edits    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">7/22/2015   </td><td class="markdownTableBodyNone">Design review actions    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">9/28/2015   </td><td class="markdownTableBodyNone">Unit Test Review additions   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="svc.html">Svc Components, Ports, and Classes</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
